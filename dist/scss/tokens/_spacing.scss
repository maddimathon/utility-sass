///
/// @package @maddimathon/utility-sass@0.1.0-alpha.29
/// @since 0.1.0-pre.0
///

@use '../modules/map';
@use '../modules/math';

@use '../config';
// @use 'functions' as *;

/// # TOKENS - MARGINS
/// ======================================================================== ///

///
/// Factor for 'softening' margins for --mrg-soft-### tokens.
///
/// @since 0.1.0-pre.0
///
$margin_softener: null !default;
$margin_softener: config.config-valid-number(
    $margin_softener,
    'margin_softener',
    $default: 0.625
);

///
/// The base value for the 400-level margin value.
///
/// @since 0.1.0-alpha.22
///
$margin_base: null !default;
$margin_base: config.config-valid-number(
    $margin_base,
    'margin_base',
    $default: 1.25
);

///
/// Used for scaling various size sets relative to each other - e.g., margins,
/// font sizes, line heights.
///
/// @since 0.1.0-pre.0
///
$scaleMultiplier: null !default;
$scaleMultiplier: config.config-valid-number(
    $scaleMultiplier,
    'scaleMultiplier',
    $default: 1.15625
);

///
/// A map (merged with the defaults) of margin levels used as tokens throught
/// the system.
///
/// Default keys are '100', '200', '300', '400', '600', and '800'. After
/// merging, values are rounded with math.round-to-pixel().
///
/// @since 0.1.0-pre.0
///
$margins: () !default;

$margins: map.ksort(
    map.merge(
        (
            '100': -9,
            '200': -6,
            '300': -3,
            '400': 0,
            '500': 2,
            '600': 4,
            '800': 8,
            '900': 12,
        ),
        $margins
    )
);

// TODO - add config option for the 1.25 multiplier - $margin_base
@each $key, $size in $margins {
    $margins: map.set(
        $margins,
        $key,
        math.round-to-pixel(math.pow($scaleMultiplier, $size) * $margin_base)
    );
}

$_layoutVW_default: 8;

///
/// @since 0.1.0-pre.0
///
$layoutVW: null !default;
$layoutVW: config.config-valid-number(
    $layoutVW,
    'layoutVW',
    $default: $_layoutVW_default,
    $min: 2
);

$_gap_tab: config.config-round-to-pixel(
    calc($layoutVW * (5 / $_layoutVW_default)),
    8
);

$_gap_indent: config.config-round-to-pixel(
    calc($layoutVW * (9 / $_layoutVW_default)),
    8
);

$_gap_block_layout: config.config-round-to-pixel(
    calc($layoutVW * (5 / $_layoutVW_default)),
    8
);

///
/// Gaps are responsive margins to be used at the page layout level.
///
/// @since 0.1.0-pre.0
///
$gaps: (
    block: (
        'layout': $_gap_block_layout,
        'layout-half': calc($_gap_block_layout / 2),
    ),

    inline: (
        'indent': $_gap_indent,
        'layout': $layoutVW,
        'layout-half': calc($layoutVW/2),
        'tab': $_gap_tab,
    ),
);
