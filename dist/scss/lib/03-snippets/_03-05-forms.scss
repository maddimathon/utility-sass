///
/// @package @maddimathon/utility-sass@0.1.0-alpha.draft
/// @since 0.1.0-alpha.draft
///

@use '../../modules/math';
@use '../../modules/meta';
@use '../../modules/string';

@use '../01-functions' as *;
@use '../02-mixins' as *;

// @use '03-00-abstracts' as *;
// @use '03-01-accessibility' as *;
// @use '03-02-objects' as *;
// @use '03-03-typography' as *;
// @use '03-04-lists' as *;

/// # SNIPPETS - TYPOGRAPHY
/// ======================================================================== ///

///
/// Base styles for a button element.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-button(
    $accentClr: ButtonText,
    $accentClr_active: ActiveText,
    $accentClr_hover: ButtonText,

    $borderClr: ButtonBorder,
    $borderClr_hover: SelectedItem,
    $borderClr_active: ButtonBorder,

    $background: ButtonFace,
    $background_hover: SelectedItem,
    $background_active: ButtonFace,

    $color: ButtonText,
    $color_hover: SelectedItemText,
    $color_active: ButtonText,

    $borderWidth: 0.125rem,
    $lh: '100',
    $margin: var-mrg-firm('400') 0 var-mrg-half('400'),
    $opacity_hover: 0.875,
    $padding: var-mrg-soft('200') var-mrg-firm('300'),
    $width: fit-content,

    $args...
) {
    $args: meta.keywords($args);

    @include snippet-input(
        $accentClr: $accentClr,
        $accentClr_active: $accentClr_active,
        $accentClr_hover: $accentClr_hover,

        $borderClr: $borderClr,
        $borderClr_hover: $borderClr_hover,
        $borderClr_active: $borderClr_active,

        $background: $background,
        $background_hover: $background_hover,
        $background_active: $background_active,

        $color: $color,
        $color_hover: $color_hover,
        $color_active: $color_active,

        $borderWidth: $borderWidth,
        $lh: $lh,
        $margin: $margin,
        $opacity_hover: $opacity_hover,
        $padding: $padding,
        $width: $width,

        $includePlaceholder: false,
        $args...
    );

    & {
        appearance: button;
        text-decoration: none;
        cursor: pointer;
    }
}

///
/// Base styles for a fieldset element.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-fieldset(
    $background: Canvas,

    $borderClr: AccentColor,
    $borderClr_hover: ActiveText,
    $borderClr_active: AccentColor,

    $color: CanvasText,

    $borderWidth: 0.0625rem,
    $margin: var-mrg-firm('400') 0 var-mrg-half('400'),
    $padding: var-mrg-soft('300') var-mrg-firm('400') var-mrg-firm('300'),
    $includeClrs: true
) {
    display: block;
    margin: #{$margin};
    padding: #{$padding};

    border: #{$borderWidth} solid #{$borderClr};
    border-radius: 0;

    @if $includeClrs {
        background-color: #{$background};
        color: #{$color};
    }

    /// STATES ///

    @if $includeClrs {
        @include focus-visible-or-within {
            border-color: #{$borderClr_hover};
        }

        &:active {
            border-color: #{$borderClr_active};
        }
    }

    /// BLOCK ///

    legend {
        display: block;
    }
}

///
/// Base styles for an input element.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-input(
    $accentClr: FieldText,
    $accentClr_active: ActiveText,
    $accentClr_hover: FieldText,

    $background: Field,
    $background_active: Field,
    $background_hover: Field,

    $borderClr: FieldText,
    $borderClr_active: FieldText,
    $borderClr_hover: FieldText,

    $color: FieldText,
    $color_active: FieldText,
    $color_hover: FieldText,

    $color_placeholder: currentColor,

    $display: block,
    $lh: '200',
    $borderWidth: 0.0625rem,
    $margin: var-mrg-firm('400') 0 var-mrg-half('400'),
    $opacity_hover: 1,
    $padding: var-mrg-soft('200') var-mrg-firm('200'),
    $width: 100%,

    $includeClrs: true,
    $includePlaceholder: true,
    $selector: #{&}
) {
    display: #{$display};
    margin: #{$margin};
    padding: #{$padding};
    width: #{$width};

    font: inherit;
    line-height: #{var-line-height($lh)};

    border: #{$borderWidth} solid #{$borderClr};
    border-radius: 0;

    @if $includeClrs {
        background-color: #{$background};
        color: #{$color};
        accent-color: #{$accentClr};
    }

    /// STATES ///

    $_opacityIsLessThanOne: if(
        math.unit($opacity_hover) == '%',
        $opacity_hover < 100%,
        $opacity_hover < 1
    );

    @include hover-focus-visible-or-within {
        @if $includeClrs {
            background-color: #{$background_hover};
            border-color: #{$borderClr_hover};
            color: #{$color_hover};
            accent-color: #{$accentClr_hover};
        }

        @if $_opacityIsLessThanOne {
            opacity: #{$opacity_hover};
        }
    }

    @if $_opacityIsLessThanOne {
        // TODO - un comment
        // @include colour-mode-js-support(
        //     $modes: (
        //         high,
        //         forced-colors,
        //     ),
        //     $key: 'focusVisible'
        // ) {
        //     &:focus-visible {
        //         opacity: 1;
        //     }
        // }
        @include colour-mode-interactive-mixin(
            $modes: (
                high,
                forced-colors,
            ),
            $hover: true,
            $focus: true,
            $focusWithin: true
        ) {
            opacity: 1;
        }
    }

    &:active {
        @if $includeClrs {
            background-color: #{$background_active};
            border-color: #{$borderClr_active};
            color: #{$color_active};
            accent-color: #{$accentClr_active};
        }
    }

    /// BLOCK ///

    @if $includePlaceholder {
        $_clr: if($includeClrs, $color_placeholder, currentColor);

        &::placeholder {
            opacity: 1;

            color: #{$_clr};
            color: color-mix(in srgb, #{$_clr} 62.5%, transparent);

            @include high-contrast {
                color: color-mix(in srgb, #{$_clr} 87.5%, transparent);
            }

            @include forced-colors {
                color: #{$_clr};
            }
        }
    }
}

///
/// Base styles for the types of an element. Uses the & as input.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-input-types(
    $accentClr: FieldText,
    $accentClr_active: ActiveText,
    $accentClr_hover: FieldText,

    $includeBase: true,

    $includeClrs: true
) {
    @if $includeBase {
        @include snippet-input;
    }

    &[type='button'],
    &[type='checkbox'],
    &[type='color'],
    &[type='date'],
    &[type='datetime-local'],
    &[type='file'],
    &[type='month'],
    &[type='radio'],
    &[type='range'],
    &[type='reset'],
    &[type='submit'],
    &[type='time'],
    &[type='week'] {
        cursor: pointer;
    }

    &[type='email'],
    &[type='month'],
    &[type='number'],
    &[type='password'],
    &[type='search'],
    &[type='tel'],
    &[type='text'],
    &[type='url'],
    &[type='week'] {
        cursor: text;
    }

    &[type='checkbox'],
    &[type='radio'] {
        display: inline-block;
        padding: 0;
        width: auto;

        @if $includeClrs {
            accent-color: #{$accentClr};

            @include hover-focus-visible-or-within {
                accent-color: #{$accentClr_hover};
            }

            &:active {
                accent-color: #{$accentClr_active};
            }
        }
    }

    &[type='color'] {
        padding: 0;
        height: 2.25em;
        width: 2.25em;
    }

    &[type='date'],
    &[type='datetime-local'],
    &[type='file'],
    &[type='month'],
    &[type='time'],
    &[type='week'] {
        width: auto;
    }

    &[type='file'] {
        padding-block: #{var-mrg-soft('300')};
        padding-inline: #{var-mrg-firm('300')};
        font-size: #{var-fs(smaller-1)};
    }

    &[type='range'] {
        padding: 0;
    }
}

///
/// Base styles for a form label, including check and radio boxes.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-label(
    $color: CanvasText,
    $color_checkradio: CanvasText,
    //
    $gap: var-mrg-soft('300'),
    $lh_checkradio: var-line-height('400'),
    $lh: var-line-height('200'),
    $marginBlock_innercheckradio: var-mrg-firm('200'),
    $marginBlock: var-mrg-firm('400'),
    //
    $includeClrs: true
) {
    display: block;
    margin: #{$marginBlock} 0 0;
    font-weight: 600;
    line-height: #{$lh};

    @if $includeClrs {
        color: #{$color};
    }

    &:has(> :where(input[type='checkbox'], input[type='radio'])) {
        display: grid;
        grid-template-columns: fit-content(0) 1fr;
        justify-content: end;
        align-items: baseline;
        gap: #{$gap};

        font-weight: 400;
        line-height: #{$lh_checkradio};
        text-wrap: balance;

        @if $includeClrs {
            color: #{$color_checkradio};
        }

        cursor: pointer;

        & + & {
            margin-block-start: #{$marginBlock_innercheckradio};
        }

        + %_input-base {
            margin-block-start: #{$marginBlock};
        }
    }

    > input[type='checkbox'],
    > input[type='radio'] {
        margin-block: 0;
    }
}
