///
/// @package @maddimathon/utility-sass@0.1.0-alpha.draft
/// @since 0.1.0-alpha.draft
///

@use '../../config';
@use '../../tokens';

@use '../../../../modules/colour';
@use '../../../../modules/map';
@use '../../../../modules/meta';

@use '../../../../lib' as *;

/// # FUNCTIONS - Tokens
/// ======================================================================== ///

$_flattenedColours: map.flatten(tokens.$colours);

///
/// Returns the appropriate var (with fallback)
///
/// @param {string} $slugLevel  The sluge and level combined into a string 'slug-###'.
///
@function var-clr($slug, $level, $mode: config.$brightnessMode_default) {
    // returns
    @if not map.has-key(tokens.$colours, '#{$slug}') {
        @warn "$slug '#{$slug}' was not a key in tokens.$colours";
        @return var(--clr-#{$slug}-#{$level});
    }

    $slugMap: map.get(tokens.$colours, $slug);

    // returns
    @if meta.type-of($slugMap) != map or not map.has-key($slugMap, '#{$level}')
    {
        @warn "$level '#{$level}' was not a key in tokens.$colours.#{$slug}";
        @return var(--clr-#{$slug}-#{$level});
    }

    $dark_level: colour.shade-map-reverse-key(
        $level,
        $slugMap,
        $sort: if(config.$tokens_expandClrMaps, false, true)
    );

    @return var(
        --clr-#{$slug}-#{$level},
        #{map.get($slugMap, if($mode == dark, '#{$dark_level}', '#{$level}'))}
    );
}
